function dataTicketFollowUp(ticket_id) {
  if (ticket_id == undefined || ticket_id == '') {
    alert('please input ticket_id')
  } else {
    fetch(`/api/kpi-followup/${ticket_id}`)
      .then(data => {
        return data.json();
      }).then(json => {
        $('#kpi-ticket').html('')
        $('#kpi-ticket').html(mapTicketFollowUp(json))
      }).catch(err => {
        $('#kpi-ticket').html('')
        $('#kpi-ticket').html(notFound())
      })
  }
}

function mapTicketFollowUp(data) {
  let page = ""
  page += "<div class='card'>"
  page += "<div class='card-header'> รายละเอียด </div>"
  page += "<div class='card-body'>"
  page += "<div class='row col-md-11 offset-md-1 padding-left-0'>"
  page += "<div class='row col-sm-12 col-md-6'>"
  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='ticket_id'>เลขที่ปัญหา </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='ticket_id'>" + data.ticket_id + "</label>"
  page += "</div>"
  page += "</div>"
  page += "<div class='row col-sm-12 col-md-6'>"
  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='open_time'>วันที่เปิดรับ </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='open_time'>" + data.open_time + "</label>"
  page += "</div>"
  page += "</div>"
  page += "<div class='row col-sm-12 col-md-6'>"
  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='add_name'>ชื่อผู้รับปัญหา </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='add_name'>" + data.add_name + "</label>"
  page += "</div>"
  page += "</div>"
  page += "<div class='row col-sm-12 col-md-6'>"
  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='close_time'>วันที่ปิด </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='close_time'>" + data.close_time + "</label>"
  page += "</div>"
  page += "</div>"
  page += "<div class='row col-sm-12 col-md-6'>"
  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='owner_name'>ชื่อเจ้าของปัญหา </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='owner_name'>" + data.owner_name + "</label>"
  page += "</div>"
  page += "</div>"
  page += "<div class='row col-sm-12 col-md-6'>"
  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='ticket_status'>สถานะ </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='ticket_status'>" + data.ticket_status + "</label>"
  page += "</div>"
  page += "</div>"
  page += "</div>"
  page += "<div class='row col-md-11 offset-md-1 padding-left-0'>"
  page += "<div class='row col-sm-12 col-md-6'>"
  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='customer_id'>รหัสลูกค้า </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='customer_id'>" + data.customer_id + "</label>"
  page += "</div>"
  page += "</div>"
  page += "<div class='row col-sm-12 col-md-6'>"
  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='customer_name'>ชื่อลูกค้า </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='customer_name'>" + data.customer_name + "</label>"
  page += "</div>"
  page += "</div>"
  page += "<div class='row col-sm-12 col-md-6'>"
  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='caller_name'>ข้อมูลผู้ติดต่อ </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='caller_name'>" + data.caller_name + "</label>"
  page += "</div>"
  page += "</div>"
  page += "<div class='row col-sm-12 col-md-6'>"
  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='caller_phoneno'>โทรศัพท์ </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='caller_phoneno'>" + data.caller_phoneno + "</label>"
  page += "</div>"
  page += "</div>"
  page += "</div>"
  page += "<div class='row col-md-11 offset-md-1 padding-left-0'>"
  page += "<div class='row col-sm-12 col-md-6'>"
  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='system'>ระบบงานหลัก </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='system'>" + data.system + "</label>"
  page += "</div>"

  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='subsystem'>ระบบงานย่อย </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='subsystem'>" + data.subsystem + "</label>"
  page += "</div>"

  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='module'>หัวข้อหลัก </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='module'>" + data.module + "</label>"
  page += "</div>"

  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='item'>หัวข้อย่อย </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='item'>" + data.item + "</label>"
  page += "</div>"

  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='problem_type'>ปัญหา </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='problem_type'>" + data.problem_type + "</label>"
  page += "</div>"

  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='subproblem_type'>ปัญหาย่อย </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='subproblem_type'>" + data.subproblem_type + "</label>"
  page += "</div>"

  page += "<div class='col-sm-5 padding-right-0 padding-left-30 custom-control custom-checkbox'>"
  if (data.mass_problem) {
    page += "<input class='custom-control-input' type='checkbox' id='mass_problem' disabled='' checked>"
  } else {
    page += "<input class='custom-control-input' type='checkbox' id='mass_problem' disabled=''>"
  }
  page += "<label class='custom-control-label font-weight-bold' for='mass_problem'>mass problem</label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0 '>"
  page += "<label class='padding-left-5 font-weight-bold' for='conserv_tool_choice_1'>ติดตามปัญหาครั้งที่</label>"
  page += "<label class='padding-left-5' id='call_times'>" + data.call_times + "</label>"
  page += "</div>"
  page += "</div>"
  page += "<div class='row col-sm-12 col-md-6'>"

  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' class='font-weight-bold' for='channel'>รับเรื่องทาง </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='channel'>" + data.channel + "</label>"
  page += "</div>"

  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='province'>จังหวัด </label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='province'>" + data.province + "</label>"
  page += "</div>"

  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='severity_level'>ความรุนแรง</label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='severity_level'>" + data.severity_level + "</label>"
  page += "</div>"

  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='priority_level'>ความสำคัญ</label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='priority_level'>" + data.priority_level + "</label>"
  page += "</div>"

  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='need_day'>กำหนด (ว:ช:น)</label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='need_day'>" + data.need_day + "</label> /"
  page += "<label class='padding-left-5' id='need_hr'>" + data.need_hr + "</label> /"
  page += "<label class='padding-left-5' id='need_mi'>" + data.need_mi + "</label>"
  page += "</div>"

  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='reminder_time'>วันที่ครบกำหนด</label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label class='padding-left-5' id='reminder_date'>" + data.reminder_date + "</label>"
  page += "<label class='padding-left-5' id='reminder_time'>" + data.reminder_time + "</label>"
  page += "</div>"

  page += "<div class='col-sm-5 padding-right-0'>"
  page += "<label class='font-weight-bold' for='close_date'>วันที่ติดตามปัญหา</label>"
  page += "</div>"
  page += "<div class='col-sm-7 padding-left-0'>"
  page += "<label id='close_date'>" + data.close_date + "</label>"
  page += "</div>"
  page += "</div>"
  page += "</div>"
  page += "<div class='row col-md-11 offset-md-1 padding-left-0'>"
  page += "<div class='col-sm-2 padding-right-0'><label class='font-weight-bold' for='problem_detail'>รายละเอียดปัญหา </label>"
  page += "</div>"
  page += "<div class='col-sm-10 padding-left-28'><label id='problem_detail'>" + data.problem_detail + "</label>"
  page += "</div>"
  page += "</div>"
  page += "<div class='row col-md-11 offset-md-1 padding-left-0'>"
  page += "<div class='col-sm-2 padding-right-0'><label class='font-weight-bold' for='resolved_detaill'>วิธีการแก้ไขปัญหา </label>"
  page += "</div>"
  page += "<div class='col-sm-10 padding-left-28'><label id='resolved_detaill'>" + data.resolved_detaill + "</label>"
  page += "</div>"
  page += "</div>"

  page += "</div>"
  page += "</div>"
  return page;
}

function notFound() {
  let page = ""
  page += "<div class='card'>"
  page += "<div class='card-header'>รายละเอียด</div>"
  page += "<div class='card-body text-center'>"
  page += "ไม่พบข้อมูล"
  page += "</div>"
  page += "</div>"
  return page;
}